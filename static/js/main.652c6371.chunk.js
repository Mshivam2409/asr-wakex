(this["webpackJsonpasr-answering-example"]=this["webpackJsonpasr-answering-example"]||[]).push([[0],{325:function(e,t,n){e.exports=n(379)},326:function(e,t,n){},344:function(e,t){},345:function(e,t){},353:function(e,t){},363:function(e,t){},364:function(e,t){},365:function(e,t){},366:function(e,t){},374:function(e,t){},379:function(e,t,n){"use strict";n.r(t);n(326);var o,a=n(32),c=n.n(a),i=n(265),s=n.n(i),r=n(5),u=n.n(r),l=n(11),d=n(4),p=n(6),m=n(7),b=n(266),f=n.n(b),g=n(160),h=n.n(g),O=n(220),z=n(267),w=n(268),j=(n(378),n(199),n(322)),S=function(e){var t=Object(a.useState)(0),n=Object(d.a)(t,2),o=n[0],c=n[1],i=Object(a.useState)(!1),s=Object(d.a)(i,2),r=s[0],u=s[1],l=Object(a.useState)(!1),p=Object(d.a)(l,2),m=p[0],b=p[1],g=Object(a.useState)(""),h=Object(d.a)(g,2),O=h[0],z=h[1];return[function(){try{navigator.mediaDevices.getUserMedia({audio:!0}).then((function(t){window.AudioContext=window.AudioContext||window.webkitAudioContext,function(t,n){var o={onVoiceStart:function(){u(!0)},onVoiceStop:function(){u(!1)},onUpdate:function(e){c(e)}},a=f()(t,n,o).destroy;setTimeout((function(){a()}),e)}(new AudioContext,t)})).catch((function(e){return b(!0),void z("Could not connect microphone. Possible rejected by the user or is blocked by the browser.")}))}catch(t){b(!0),z("Mic input is not supported by the browser.")}},r,o,m,O]};!function(e){e.BUZZIN_COMMAND="go",e.BUZZOUT_COMMAND="stop"}(o||(o={}));var _=Object(p.a)((function e(t,n){var a=this;Object(m.a)(this,e);var c=this;this.intialize=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c._recognizer.ensureModelLoaded();case 2:console.log(c._recognizer.wordLabels()),c._init=!0;case 4:case"end":return e.stop()}}),e)}))),this.argMax=function(e){for(var t=0,n=-1,o=0;o<e.length;o++)e[o]>t&&(t=e[o],n=o);return n},this.update=function(e){e.forEach((function(e){a._commands[e.command]=e.callback}))},this.listen=function(){a._recognizer.isListening()?a._recognizer.stopListening().then((function(){a._listen()})):a._listen()},this._listen=function(){a._recognizer.listen((function(e){var t=a._recognizer.wordLabels()[a.argMax(e.scores)];return t==o.BUZZIN_COMMAND&&a._buzzedin?Promise.resolve():t!=o.BUZZOUT_COMMAND||a._buzzedin?(t!=o.BUZZIN_COMMAND||a._buzzedin?t!=o.BUZZOUT_COMMAND||a._buzzedin||(a._buzzedin=!1):a._buzzedin=!0,new Promise((function(e,n){if(a._last_command!=t){a._last_command=t;try{t in a._commands&&(a._commands[t](),e())}catch(o){n()}}e()}))):Promise.resolve()}),{includeSpectrogram:!0,probabilityThreshold:a._threshold})},this.stop=function(){a._recognizer.isListening()&&a._recognizer.stopListening()},this._recognizer=Object(j.a)("BROWSER_FFT"),this._init=!1,this._commands={},(t||[]).forEach((function(e){a._commands[e.command]=e.callback})),this._last_command="",this._threshold=n||.9,this._buzzedin=!1})),v=function(e){var t=Object(a.useState)([]),n=Object(d.a)(t,2),c=n[0],i=n[1],s=Object(a.useState)(!1),r=Object(d.a)(s,2),p=r[0],m=r[1],b=Object(a.useState)(),f=Object(d.a)(b,2),j=f[0],v=f[1],A=Object(a.useState)(!0),E=Object(d.a)(A,2),R=E[0],M=E[1],y=Object(O.a)(e.audio.buzzin),k=Object(d.a)(y,1)[0],C=Object(O.a)(e.audio.buzzout),x=Object(d.a)(C,1)[0],L=Object(a.useState)(!1),B=Object(d.a)(L,2),U=B[0],N=B[1],Z=Object(a.useState)("unknown"),T=Object(d.a)(Z,2),I=T[0],D=T[1],P=Object(w.a)(e.timeout,100),F=Object(d.a)(P,2),V=F[0],G=F[1],J=G.start,Y=G.reset,q=S(e.totalGameTime),W=Object(d.a)(q,5),H=W[0],K=W[1],Q=W[2],X=W[3],$=W[4],ee=[{command:"Stop",callback:function(e){p&&!R&&(console.log("[ASR] : Stopped"),m(!1),ce(),se._buzzedin=!1)},isFuzzyMatch:!0,fuzzyMatchingThreshold:.2}],te=Object(g.useSpeechRecognition)({commands:ee});h.a.startListening({continuous:!0});try{navigator.permissions.query({name:"microphone"}).then((function(e){D(e.state)}))}catch(X){console.log("error")}var ne=Object(z.useReactMediaRecorder)({audio:!0,onStop:function(e,t){v(t)}}),oe=ne.status,ae=ne.startRecording,ce=ne.stopRecording,ie=[{command:o.BUZZIN_COMMAND,callback:function(){console.log("[ASR] : Ready: ".concat(U,", Finished: ").concat(R)),U&&R&&!p&&(M(!1),te.resetTranscript(),Y(),J(),console.log("[SR] Buzzed In"),e.onBuzzin(),k(),ae(),i([]),m(!0))}},{command:o.BUZZOUT_COMMAND,callback:function(){p&&!R&&(console.log("[ASR] : Stopped"),m(!1),ce())}}],se=new _(ie,e.ASRthreshold);Object(a.useEffect)((function(){100===V&&(console.log(p,R),p&&!R&&ce())}),[V]),Object(a.useEffect)((function(){"stopped"==oe&&(console.log("[ASR] Blob Ready"),function(){if(te.finalTranscript.length>=0&&j){x();var t=te.finalTranscript;h.a.stopListening(),e.onComplete(t.split(" ").slice(0,-1).join(" ").toLowerCase().replace("go".toLowerCase(),"").replace("stop".toLowerCase(),"").replace(/[^\w\s]|_/g,""),j)}j&&M(!1)}())}),[j]);var re={ASR:h.a.browserSupportsSpeechRecognition(),Mic:I},ue=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se.intialize();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){console.log("[ASR] State changed to ",U,"! Updating Commands"),se.update(ie),se.stop(),se.listen(),console.log("[ASR] Updated Commands")}),[U,R,p]),{initialize:ue,startListening:function(){se.listen(),H()},stopListening:function(){se.stop()},listening:p,recordingState:oe,timeLeft:V,voiceState:K,volume:Q,answer:c,permissions:re,error:X,errormsg:$,ready:U,setIsReady:function(e){console.log(e),N(e)}}},A=function(){var e=Object(a.useState)(!1),t=Object(d.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(""),s=Object(d.a)(i,2),r=s[0],p=s[1],m=Object(a.useState)(""),b=Object(d.a)(m,2),f=b[0],g=b[1],h=v({audio:{buzzin:"https://assets.mixkit.co/sfx/download/mixkit-game-show-wrong-answer-buzz-950.wav",buzzout:"https://assets.mixkit.co/sfx/download/mixkit-game-show-wrong-answer-buzz-950.wav"},onAudioData:function(){},timeout:1e4,onComplete:function(){var e=Object(l.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(t),o(!1),g(URL.createObjectURL(n)),console.log(t,n);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),onBuzzin:function(){o(!0),console.log("Buzzed In")},ASRthreshold:.8,totalGameTime:300}),O=h.initialize,z=h.startListening,w=h.stopListening,j=h.voiceState,S=h.volume,_=h.permissions,A=h.setIsReady,E=h.ready;return c.a.createElement("div",{className:"App"},c.a.createElement("header",{className:"App-header"},c.a.createElement("p",null,"ASR is ".concat(E?"ready":"not ready"," to use.")),c.a.createElement("p",null,"Press Enable to enable ASR. ",c.a.createElement("br",null)," Press listen to start listening, speak go, then you will buzz in, speak your answer, then speak stop.",c.a.createElement("br",null),"You must wait around 3-4s after saying stop to allow time for processing.",c.a.createElement("br",null)," Press stop to turn off ASR.",c.a.createElement("br",null),"You can listen to recorded audio after processing ends."),c.a.createElement("p",null,"Mic permission is ".concat(_.Mic)),c.a.createElement("p",null,"Browser Supports ASR : ".concat(_.ASR)),c.a.createElement("p",null,"Volume is ".concat(S)),c.a.createElement("p",null,"Speaking :  ".concat(j)),c.a.createElement("button",{onClick:Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:A(!0),O().then((function(){z(),console.log("Ready to listen!")}));case 2:case"end":return e.stop()}}),e)})))},"ENABLE"),c.a.createElement("button",{onClick:function(){z()}},"LISTEN"),c.a.createElement("button",{onClick:function(){w()}},"STOP"),c.a.createElement("p",null," ".concat(n?"Buzzed In":"Not Buzzed In",".")),c.a.createElement("p",null,"Answer is ".concat(r,".")),""!==f&&c.a.createElement("audio",{controls:!0,src:f})))};s.a.render(c.a.createElement(A,null),document.getElementById("root"))}},[[325,1,2]]]);
//# sourceMappingURL=main.652c6371.chunk.js.map